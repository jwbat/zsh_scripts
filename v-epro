#!/bin/zsh

grey=$(ts 252)
lightblue=$(ts 153)
gold=$(ts 220)
pale=$(ts 242)
salmon=$(ts 216)
honeydew=$(ts 194)


echo "
$salmon ---------------------------------------------------------------------------------------------------------------

$grey 
\t # UUID's created via PSQL's gen_random_uuid() $lightblue

   site_uuid     = '9f02171a-32a0-4695-a7f2-aad43528af58'
   device_A_uuid = 'a2204077-054e-49f3-ba0c-17a34cd01800'  $grey# Phase-A-DA9D $lightblue
   device_B_uuid = '7b794dd5-e29c-4851-a533-100c57dc4cff'  $grey# Phase-B-0673 $lightblue
   device_C_uuid = 'ef66fc2c-3c42-458c-abc7-cbfe9aca52ac'  $grey# Phase-C-8DFB $lightblue
$yellow
   kWh = (Ah * V) / 1000

$honeydew======================================================================================================================
$grey # SQL  $gold
select STAMP, data:\"accumulated_nanoampere_hour\" as NA, data:\"supply_voltage\" from \"SBG\".\"SBG_STATE_TRANSFER\" 
where DEVICEUUID='7b794dd5-e29c-4851-a533-100c57dc4cff'
  and SITEUUID='9f02171a-32a0-4695-a7f2-aad43528af58'      
  and data:\"accumulated_nanoampere_hour\" in (
    select max(data:\"accumulated_nanoampere_hour\") from \"SBG\".\"SBG_STATE_TRANSFER\" 
    group by DEVICEUUID, date(STAMP)
  ) 
order by STAMP asc;

$honeydew======================================================================================================================
$grey # request  $gold
query Energy {
  energyConsumptionByTime(
    siteUuid: \"9f02171a-32a0-4695-a7f2-aad43528af58\",
    deviceUuid: \"7b794dd5-e29c-4851-a533-100c57dc4cff\",
    startDate: \"2022-06-21\",
    endDate: \"2022-07-01\") {
    points {
      time
      kWh
    }
  }
}

$grey # response $lightblue
{
  \"data\": {
    \"energyConsumptionByTime\": {
      \"points\": [
        {
          \"time\": \"2022-06-21\",
          \"kWh\": 1.982159603307
        },
        {
          \"time\": \"2022-06-22\",
          \"kWh\": 2.088167924115
        },
        {
          \"time\": \"2022-06-23\",
          \"kWh\": 1.040813534475
        },
        {
          \"time\": \"2022-06-24\",
          \"kWh\": 1.1886646297499999
        },
        ...
"


exit 0
